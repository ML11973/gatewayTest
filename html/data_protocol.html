<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WPAN Gateway: Data transfer protocol</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WPAN Gateway
   </div>
   <div id="projectbrief">A low-power border router</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="protocols.html">Node protocols</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Data transfer protocol </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This protocol allows exchange of UDP datagrams between node and gateway. It does not have commands.</p>
<p>The communicators split the <em>datagram</em> in <em>packets</em> small enough for transmission using ISM3 module. This maximal size is defined by <a class="el" href="wpan_8h.html#a13d83ce0d8fa43a5c7e8cd37718ed4e1" title="Maximal number of bytes to fit in a data packet.">DATA_MAX_PACKET_LENGTH</a>.</p>
<p>The packet header allows reconstruction of the original datagram if all packets were received. No error detection is performed. Datagrams with missing packets are marked as valid unless the last packet is missing. In the latter case, they are open to completion and should be cleared periodically.</p>
<p>Frame definition :</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Offset   </th><th class="markdownTableHeadCenter">Length   </th><th class="markdownTableHeadNone">Data    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0   </td><td class="markdownTableBodyCenter">1   </td><td class="markdownTableBodyNone">Protocol ID: <a class="el" href="wpan_8h.html#adf90b5b889303c39389480e07b6a46cc" title="Data protocol ID.">DATA_PROTOCOL_ID</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">1   </td><td class="markdownTableBodyCenter">m   </td><td class="markdownTableBodyNone">Datagram ID    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">1+m   </td><td class="markdownTableBodyCenter">n   </td><td class="markdownTableBodyNone">Current packet index    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">1+m+n   </td><td class="markdownTableBodyCenter">n   </td><td class="markdownTableBodyNone">Last packet index    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">1+m+2*n   </td><td class="markdownTableBodyCenter">X   </td><td class="markdownTableBodyNone">raw data   </td></tr>
</table>
<p>n = size of <a class="el" href="wpan_8h.html#a082f45f9fcf1bbb69666cfb32bdb466f" title="Packet index type.">packet_index_t</a></p>
<p>m = size of <a class="el" href="wpan_8h.html#aba17fbce45abc3b1beab919d5854f6c6" title="Datagram ID type.">datagram_id_t</a></p>
<p>Max value of X is defined in <a class="el" href="wpan_8h.html#a13d83ce0d8fa43a5c7e8cd37718ed4e1" title="Maximal number of bytes to fit in a data packet.">DATA_MAX_PACKET_LENGTH</a>. It depends on <a class="el" href="wpan_8h.html#a082f45f9fcf1bbb69666cfb32bdb466f" title="Packet index type.">packet_index_t</a> and <a class="el" href="wpan_8h.html#aba17fbce45abc3b1beab919d5854f6c6" title="Datagram ID type.">datagram_id_t</a> size. Default implementation has m=n=1. In practice, it is impossible at the moment to reliably transmit more than 3 consecutive packets, limiting datagram size to 705. This limit is probably sufficient for our low-power, low-data rate application. It could probably pointlessly be surpassed with a different PHY layer. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
