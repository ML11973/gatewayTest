<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WPAN Gateway: Power Nodes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WPAN Gateway
   </div>
   <div id="projectbrief">A low-power border router</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="code_overview.html">Codebase overview</a></li><li class="navelem"><a class="el" href="wpanManager_desc.html">WPAN Manager</a></li><li class="navelem"><a class="el" href="nodes.html">Nodes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Power Nodes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md45"></a>
Description</h2>
<p><a class="el" href="classPowerNode.html" title="Reprensentation of a distant power node. See Power Nodes page for details.">PowerNode</a> refers to <a class="el" href="nodes.html">Nodes</a> that measure, consume and-or produce electrical power in an electrical installation.</p>
<p>The <a class="el" href="classPowerNode.html" title="Reprensentation of a distant power node. See Power Nodes page for details.">PowerNode</a> class provides the user with a representation of the remote node with the following:</p><ul>
<li>A text description</li>
<li>Current measured power consumption or production</li>
<li>Available power settings</li>
<li>Regulation priority</li>
</ul>
<p>The class allows setting a target power in two ways:</p><ul>
<li>setting an arbitrary power target in kW</li>
<li>setting a pre-defined power setting</li>
</ul>
<h2><a class="anchor" id="autotoc_md46"></a>
Usage</h2>
<h3><a class="anchor" id="autotoc_md47"></a>
Instantiation</h3>
<p>Instantiate using any constructor. Constructors match <a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a> type constructor. A constructor for <a class="el" href="classPowerNode.html" title="Reprensentation of a distant power node. See Power Nodes page for details.">PowerNode</a> instantiation from a <a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a> object exists.</p>
<h3><a class="anchor" id="autotoc_md48"></a>
Sending commands</h3>
<p>Use any function starting with app_ to issue an <a class="el" href="app_protocol.html">Application protocol</a> command.</p>
<p>Other operations are inherited from parent <a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a>.</p>
<h3><a class="anchor" id="autotoc_md49"></a>
Debugging</h3>
<p><a class="el" href="wpan_8h.html">wpan.h</a> provides two DEBUG macros for this class. Uncomment #DEBUG_RXTX to show all incoming and outgoing frames. Uncomment #DEBUG_APP to show only <a class="el" href="app_protocol.html">Application protocol</a> frames.</p>
<h2><a class="anchor" id="autotoc_md50"></a>
Implementation details</h2>
<h3><a class="anchor" id="autotoc_md51"></a>
Frame IO</h3>
<p>This class does not provide a method to directly transmit data to its remote node. Instead, it provides wrappers like its parent class.</p>
<h3><a class="anchor" id="autotoc_md52"></a>
Command functions</h3>
<p>As with the <a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a> class, methods starting with app_, such as <a class="el" href="classPowerNode.html#a3fdf5bf209b3413782811ff547592eb0" title="Get current node power as float.">PowerNode::app_getPower</a>, are wrappers to send the corresponding command to the remote node. They reset the corresponding callback flag if an answer is expected.</p>
<p><b>As with <a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a>, do not confuse application commands such as <a class="el" href="classPowerNode.html#a3fdf5bf209b3413782811ff547592eb0" title="Get current node power as float.">PowerNode::app_getPower</a> with getters such as <a class="el" href="classPowerNode.html#abf77c23200dc806f4c4180df5fcaf0db" title="Getter for local measured power.">PowerNode::getPower</a>!</b></p>
<h3><a class="anchor" id="autotoc_md53"></a>
Callback flags</h3>
<p>These work the same as in the <a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a> class, but with <a class="el" href="classPowerNode.html#a9f264e4192813f77fa715bd545ea56cf" title="Handles application command.">PowerNode::appCmdCallback</a>. See relevant subsection on the <a class="el" href="nodes.html">Nodes</a> page.</p>
<h3><a class="anchor" id="autotoc_md54"></a>
Class hierarchy</h3>
<p>The <a class="el" href="classPowerNode.html" title="Reprensentation of a distant power node. See Power Nodes page for details.">PowerNode</a> class is a child of the <a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a> class. It handles the <a class="el" href="app_protocol.html">Application protocol</a> and leaves the rest to its parent.</p>
<h2><a class="anchor" id="autotoc_md55"></a>
Attribute specification</h2>
<h3><a class="anchor" id="autotoc_md56"></a>
Priority</h3>
<p>Priority describes the <a class="el" href="classPowerNode.html" title="Reprensentation of a distant power node. See Power Nodes page for details.">PowerNode</a>'s priority for electrical consumption or production. A value of zero means the node's production or consumption cannot be regulated. A higher value means the node's production/consumption will be adjusted before that of lower-value nodes.</p>
<p>Production example :</p>
<p>Let node A be a solar panel. Let node B be a battery with inverter. Let node C be a diesel generator.</p>
<p>Target : minimizing power surplus.</p>
<p><a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a> A's production cannot be adjusted. A priority = 0. <a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a> B is a backup system which we do not want to draw from except in emergencies. B priority = 1. <a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a> C consumes valuable fuel, but it is acceptable burn fuel to meet energy demand in our example policy. C priority &gt; 1.</p>
<p>If node A's production picks up, we will stop node B before node C first. This means we stop using power from the emergency storage before we stop using the diesel generator.</p>
<p>Consumption example :</p>
<p>Let node A be a freezer. Let node B be a water heater. Let node C be an electric car charging station.</p>
<p>Target : minimizing power draw from the grid.</p>
<p><a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a> A's consumption cannot be adjusted lest we sacrifice its contents. A priority = 0. <a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a> B is useful, but also stores energy. Turning it off for a day would not hurt its functionality. B priority &gt; 1. <a class="el" href="classNode.html" title="Reprensentation of a distant node. See Nodes page for details.">Node</a> C ultimately does not need power every day since the charged car can go a few days without charging. C priority &gt; B priority.</p>
<p>In case of low household power production, C would be shut down first, then B.</p>
<h3><a class="anchor" id="autotoc_md57"></a>
Power</h3>
<p>Power is the current power consumption or production. Consumed power should be negative by convention. Power should be in kW by convention. These two conventions are ultimately left for the user application to specify. Power data type can be modified by changing powerkW_t, be it to switch to double precision or to accept integer precision and reduce channel usage.</p>
<p>Nodes that can precisely regulate their consumption should allow setting arbitrary power targets. This could be the case for an emergency backup power bank's charging system, for example.</p>
<p>In any case, measured power must be true and should be used for computations.</p>
<h3><a class="anchor" id="autotoc_md58"></a>
Power settings</h3>
<p>Power settings can be compared to power modes. A node cannot always regulate its power consumption precisely. Some consumers may only allow ON/OFF, some may have 3 undefined power modes.</p>
<p>Power setting description should be a power as defined in the previous section. The ideal case for a regulator would be to have access to estimated power consumptions per power mode. The <a class="el" href="classPowerNode.html#ac368afe060c61715fa6de83b97c44434" title="Get power setting list from node.">PowerNode::app_getPowerSettings</a> method is built to get power figures in kW as descriptions of the power mode. The application developer is however free to change the contents of power setting descriptions, opting for simple integers or even characters.</p>
<p>In any case, measured power should be used as the reference for computations.</p>
<p>Settings are chosen by sending their index with <a class="el" href="classPowerNode.html#aa3fe7956f1542a389384284b6490cff6" title="Set current node power setting.">PowerNode::app_setPowerSetting</a>.</p>
<h3><a class="anchor" id="autotoc_md59"></a>
Description</h3>
<p>This is a simple description sent by the remote node. It is somewhat comparable to a hostname in local networks. Its maximum size is limited by the PHY max size. It is defined in <a class="el" href="wpan_8h.html#a9d57da126c1cf06709df7a483256a95f" title="Max description length to fit in one frame.">APP_MAX_DESC_LENGTH</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
